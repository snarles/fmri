\title{Risk Inflation relative to Bayes Oracle}
\author{Charles Zheng and Yuval Benjamini}
\date{\today}

\documentclass[12pt]{article} 

% packages with special commands
\usepackage{amssymb, amsmath}
\usepackage{epsfig}
\usepackage{array}
\usepackage{ifthen}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{csquotes}
\definecolor{grey}{rgb}{0.5,0.5,0.5}

\begin{document}
\maketitle

\newcommand{\tr}{\text{tr}}
\newcommand{\E}{\textbf{E}}
\newcommand{\diag}{\text{diag}}
\newcommand{\argmax}{\text{argmax}}
\newcommand{\Cov}{\text{Cov}}
\newcommand{\Var}{\text{Var}}
\newcommand{\argmin}{\text{argmin}}
\newcommand{\Vol}{\text{Vol}}
\newcommand{\comm}[1]{}

These are preliminary notes.

\section{Ridge regression}

Suppose $\beta \sim N(0, \frac{\sigma^2\alpha^2}{p} I)$, $X \sim N^n(0, I_p)$ and $y \sim N(X\beta, \sigma^2 I_n)$.

Define the risk of ridge regression as
\[
R(\lambda) = \E ||y^* - (x^*)^T \hat{\beta}_\lambda||^2
\]
where
\[
\hat{\beta}_\lambda = (X^T X + n\lambda)^{-1} X^T y
\]
and where $x^* \sim N(0, I_p)$, $y^* \sim ((x^*)^T\beta, \sigma^2)$.

Knowing $\alpha^2$, one should set $\lambda = \lambda^*$, by
\[
\lambda^* = \frac{\gamma}{\alpha^2} = \frac{(p/n)}{\alpha^2}.
\]
However, for $\alpha^2$ unknown, we propose the following.
Choose a $\lambda = g(X)$ for some function of $X$.  We will consider
\[
g(X) = \text{const}
\]
Let $R^* = \E R(\lambda^*)$ and $R_\lambda = \E R(\lambda)$.

\textbf{Claim:} fixing $\lambda$, 
\[
\sup_{\alpha^2 \geq 0} \frac{R_\lambda}{R^*} < \infty
\]
where $\gamma = p/n$.

Implication: simply using a fixed choice of $\lambda$, one can achieve a risk that is at worst a bounded multiple of the risk of the optimal rule for choosing $\lambda$.

For now we prove a weaker, asymptotic version of the claim where
\[
\max\{\lim_{\alpha^2 \to \infty} \frac{R_\lambda}{R^*}, \frac{R_\lambda}{R^*}\bigg|_{\alpha^2 = 0} \} < \infty
\]
in the limit where $\alpha^2$, $\sigma^2$ are fixed while $n \to \infty$, $p\to\infty$, and $p/n \to \gamma$.

\subsection{Preliminaries}

In the limit, we have
\[
R(\lambda) = \frac{1}{2\gamma}\left[\alpha^2(\gamma - 1-\sqrt{Q} -\lambda\left(\frac{1 + \lambda + \gamma}{\sqrt{Q}}\right)) + \gamma\left(1 + \frac{1+\lambda+\gamma}{\sqrt{Q}}\right)\right]
\]
and in particular that
\[
R(\lambda^*) = R(\gamma\alpha^{-2}) = \frac{1}{2}\left[1 + \frac{\gamma-1}{\gamma}\alpha^2 + \sqrt{(1 + \frac{\gamma-1}{\gamma}\alpha^2)^2 + 4\alpha^2}\right]
\]

\section{Covariance estimation}

\[
S \sim W_n(\frac{1}{n}\Sigma), D = \diag(S), \hat{R} = D^{-1/2}S D^{-1/2}
\]
\[
S_\lambda = \lambda D + (1-\lambda)S
\]

Which $\lambda$ minimizes
\[
\E \tr[S_\lambda^{-1} \Sigma] + \log\det(S_\lambda)
\]

We have
\[
\log\det(\lambda D + (1-\lambda)S) = \log\det D + \log\det(\lambda I + (1-\lambda)\hat{R}) = \log\det D + \sum_{i=1}^p \log (\lambda + (1-\lambda) r_i)
\]
where $r_i$ are the eigenvalues of $\hat{R}$.

Meanwhile
\begin{align*}
\E \tr[S_\lambda^{-1} \Sigma] &=
\E \tr[(\lambda D + (1-\lambda)S)^{-1}\Sigma]
\\&= 
\frac{1}{1-\lambda} \E \tr[(\frac{\lambda}{1-\lambda}I +\hat{R})^{-1}D^{-1/2}\Sigma D^{-1/2}]
\end{align*}

Take $n, p \to \infty$.  Then $D^{-1/2}\Sigma D^{-1/2} \to R$, the true correlation.  From now we can just assume $\Sigma=R$, (ie unit marginal variances), it doesn't matter in the limit.  Then we get
\[
\E \tr[S_\lambda^{-1} \Sigma] = \frac{1}{1-\lambda} \E \tr[(\frac{\lambda}{1-\lambda}I + S)^{-1} \Sigma]
\]

We know how to evaluate the term inside, i.e. $\E \tr[(\frac{\lambda}{1-\lambda}I + S)^{-1} \Sigma]$ based on random matrix theory.




\end{document}



